import type { IncomingMessage } from 'node:http';
type Req = Pick<IncomingMessage, 'headers' | 'socket'>;
export type TrustParameter = string | number | string[];
export type TrustFunction = (addr: string, i: number) => boolean;
export type Trust = TrustFunction | TrustParameter;
type Subnet = {
    ip: string;
    range: number;
    isIPv6: boolean;
};
/**
 * Get all addresses in the request, optionally stopping
 * at the first untrusted.
 */
declare function alladdrs(req: Req, trust?: Trust): string[];
/**
 * Compile argument into trust function.
 */
declare function compile(val: string | number | string[]): (addr: string, i: number) => boolean;
/**
 * Parse IP notation string into range subnet.
 */
export declare function parseIPNotation(note: string): Subnet;
/**
 * Determine address of proxied request.
 */
export declare function proxyaddr(req: Req, trust: Trust): string;
export { alladdrs as all };
export { compile };
//# sourceMappingURL=index.d.ts.map